/*! Bootstrap 5 Tags - v1.6.7
* https://github.com/lekoala/bootstrap5-tags
* Copyright Thomas Portelange; Licensed MIT (https://github.com/lekoala/bootstrap5-tags/blob/master/LICENSE) */
function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){o=!0,s=e},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw s}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(i),!0).forEach(function(e){_defineProperty(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function _defineProperty(e,t,i){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);t=i.call(e,t||"default");if("object"!==_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _iterableToArrayLimit(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,s,r,o,a=[],l=!0,c=!1;try{if(r=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=r.call(i)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(c)throw s}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var DEFAULTS={items:[],allowNew:!1,showAllSuggestions:!1,badgeStyle:"primary",allowClear:!1,clearEnd:!1,selected:[],regex:"",separator:[],max:0,clearLabel:"Clear",searchLabel:"Type a value",showDropIcon:!0,keepOpen:!1,allowSame:!1,baseClass:"",placeholder:"",addOnBlur:!1,showDisabled:!1,hideNativeValidation:!1,suggestionsThreshold:-1,maximumItems:0,autoselectFirst:!0,updateOnSelect:!1,highlightTyped:!1,highlightClass:"",fullWidth:!0,fixed:!1,fuzzy:!1,startsWith:!1,singleBadge:!1,activeClasses:["bg-primary","text-white"],labelField:"label",valueField:"value",searchFields:["label"],queryParam:"query",server:"",serverMethod:"GET",serverParams:{},serverDataKey:"data",fetchOptions:{},liveServer:!1,noCache:!0,debounceTime:300,notFoundMessage:"",onRenderItem:function(e,t,i){return t},onSelectItem:function(e,t){},onClearItem:function(e,t){},onCreateItem:function(e,t){},onBlur:function(e,t){},onFocus:function(e,t){},onCanAdd:function(e,t,i){},confirmClear:function(e,t){return Promise.resolve()},confirmAdd:function(e,t){return Promise.resolve()},onServerResponse:function(e,t){return e.json()}},CLASS_PREFIX="tags-",LOADING_CLASS="is-loading",ACTIVE_CLASS="is-active",INVALID_CLASS="is-invalid",MAX_REACHED_CLASS="is-max-reached",SHOW_CLASS="show",VALUE_ATTRIBUTE="data-value",NEXT="next",PREV="prev",FOCUS_CLASS="form-control-focus",PLACEHOLDER_CLASS="form-placeholder-shown",DISABLED_CLASS="form-control-disabled",INSTANCE_MAP=new WeakMap,counter=0,tooltip=window.bootstrap&&window.bootstrap.Tooltip;function debounce(n){var s,r=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];clearTimeout(s),s=setTimeout(function(){n.apply(r,t)},o)}}function calcTextWidth(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=ce("span");document.body.appendChild(i),i.style.fontSize=t||"inherit",i.style.height="auto",i.style.width="auto",i.style.position="absolute",i.style.whiteSpace="no-wrap",i.innerHTML=e;t=Math.ceil(i.clientWidth);return document.body.removeChild(i),t}function removeDiacritics(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function normalize(e){return e?removeDiacritics(e.toString()).toLowerCase():""}function fuzzyMatch(e,t){if(0<=e.indexOf(t))return!0;for(var i=0,n=0;n<t.length;n++){var s=t[n];if(" "!=s&&(i=e.indexOf(s,i)+1)<=0)return!1}return!0}function hideItem(e){e.style.display="none",attrs(e,{"aria-hidden":"true"})}function showItem(e){e.style.display="list-item",attrs(e,{"aria-hidden":"false"})}function attrs(e,t){for(var i=0,n=Object.entries(t);i<n.length;i++){var s=_slicedToArray(n[i],2),r=s[0],s=s[1];e.setAttribute(r,s)}}function rmAttr(e,t){e.hasAttribute(t)&&e.removeAttribute(t)}function parseBool(e){return["true","false","1","0",!0,!1].includes(e)&&!!JSON.parse(e)}function ce(e){return document.createElement(e)}var Tags=function(){"use strict";function s(e){var t=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,s),e instanceof HTMLElement?(INSTANCE_MAP.set(e,this),counter++,this._selectElement=e,this._configure(i),this._keyboardNavigation=!1,this._searchFunc=debounce(function(){t._loadFromServer(!0)},this._config.debounceTime),this._fireEvents=!0,this._configureParent(),this._holderElement=ce("div"),this._containerElement=ce("div"),this._dropElement=ce("ul"),this._searchInput=ce("input"),this._holderElement.appendChild(this._containerElement),this._selectElement.parentElement.insertBefore(this._holderElement,this._selectElement),this._configureHolderElement(),this._configureContainerElement(),this._configureSelectElement(),this._configureSearchInput(),this._configureDropElement(),this.resetState(),this.handleEvent=function(e){t._handleEvent(e)},this._config.fixed&&(document.addEventListener("scroll",this,!0),window.addEventListener("resize",this)),this._searchInput.addEventListener("focus",this),this._searchInput.addEventListener("blur",this),this._searchInput.addEventListener("input",this),this._searchInput.addEventListener("keydown",this),this._dropElement.addEventListener("mousemove",this),this.loadData(!0)):console.error("Invalid element",e)}return _createClass(s,[{key:"dispose",value:function(){this._searchInput.removeEventListener("focus",this),this._searchInput.removeEventListener("blur",this),this._searchInput.removeEventListener("input",this),this._searchInput.removeEventListener("keydown",this),this._dropElement.removeEventListener("mousemove",this),this._config.fixed&&(document.removeEventListener("scroll",this,!0),window.removeEventListener("resize",this)),this._selectElement.style.display="block",this._holderElement.parentElement.removeChild(this._holderElement),this.parentForm&&this.parentForm.removeEventListener("reset",this),INSTANCE_MAP.delete(this._selectElement)}},{key:"handleEvent",value:function(e){this._handleEvent(e)}},{key:"_handleEvent",value:function(e){var t=this;["scroll","resize"].includes(e.type)?(this._timer&&window.cancelAnimationFrame(this._timer),this._timer=window.requestAnimationFrame(function(){t["on".concat(e.type)](e)})):this["on".concat(e.type)](e)}},{key:"_configure",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._config=Object.assign({},DEFAULTS,{showDropIcon:!!this._findOption()});for(var t=this._selectElement.dataset.config?JSON.parse(this._selectElement.dataset.config):{},i=_objectSpread(_objectSpread(_objectSpread({},e),t),this._selectElement.dataset),n=0,s=Object.entries(DEFAULTS);n<s.length;n++){var r=_slicedToArray(s[n],2),o=r[0],r=r[1];if("config"!=o&&void 0!==i[o]){var a=i[o];switch(_typeof(r)){case"number":this._config[o]=parseInt(a);break;case"boolean":this._config[o]=parseBool(a);break;case"string":this._config[o]=a.toString();break;case"object":"string"==typeof(this._config[o]=a)&&(["{","["].includes(a[0])?this._config[o]=JSON.parse(a):this._config[o]=a.split(a.includes("|")?"|":","));break;case"function":this._config[o]="string"==typeof a?a.split(".").reduce(function(e,t){return e[t]},window):a,this._config[o]||console.error("Invalid function",a);break;default:this._config[o]=a}}}this._config.placeholder||(this._config.placeholder=this._getPlaceholder()),-1==this._config.suggestionsThreshold&&(this._config.suggestionsThreshold=this._config.liveServer?1:0)}},{key:"config",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return e?this._config[e]:this._config}},{key:"setConfig",value:function(e,t){this._config[e]=t}},{key:"_configureParent",value:function(){for(this.overflowParent=null,this.parentForm=this._selectElement.parentElement;this.parentForm&&("hidden"===this.parentForm.style.overflow&&(this.overflowParent=this.parentForm),this.parentForm=this.parentForm.parentElement,!this.parentForm||"FORM"!=this.parentForm.nodeName););this.parentForm&&this.parentForm.addEventListener("reset",this)}},{key:"_getPlaceholder",value:function(){if(this._selectElement.hasAttribute("placeholder"))return this._selectElement.getAttribute("placeholder");if(this._selectElement.dataset.placeholder)return this._selectElement.dataset.placeholder;var e=this._selectElement.querySelector("option");return e&&this._config.autoselectFirst?(rmAttr(e,"selected"),e.selected=!1,e.value?"":e.textContent):""}},{key:"_configureSelectElement",value:function(){var t=this,e=this._selectElement;this._config.hideNativeValidation?(e.style.position="absolute",e.style.left="-9999px"):e.style.cssText="height:1px;width:1px;opacity:0;padding:0;margin:0;border:0;float:left;flex-basis:100%;",e.tabIndex=-1,e.addEventListener("focus",function(e){t.onclick(e)}),e.addEventListener("invalid",function(e){t._holderElement.classList.add(INVALID_CLASS)})}},{key:"_configureDropElement",value:function(){var t=this,e=this._dropElement;(i=e.classList).add.apply(i,["dropdown-menu",CLASS_PREFIX+"menu"]),e.id=CLASS_PREFIX+"menu-"+counter,e.setAttribute("role","menu");var i=e.style;i.padding="0",i.maxHeight="280px",this._config.fullWidth||(i.maxWidth="360px"),this._config.fixed&&(i.position="fixed"),i.overflowY="auto",i.overscrollBehavior="contain",i.textAlign="unset",e.addEventListener("mouseenter",function(e){t._keyboardNavigation=!1}),this._holderElement.appendChild(e),this._searchInput.setAttribute("aria-controls",e.id)}},{key:"_configureHolderElement",value:function(){var e,t=this,i=this._holderElement;(e=i.classList).add.apply(e,["form-control","dropdown"]),["form-select-lg","form-select-sm"].forEach(function(e){t._selectElement.classList.contains(e)&&i.classList.add(e)}),0==this._config.suggestionsThreshold&&this._config.showDropIcon&&i.classList.add("form-select"),this.overflowParent&&(i.style.position="inherit"),i.style.height="auto",i.addEventListener("click",this)}},{key:"_configureContainerElement",value:function(){var t=this;this._containerElement.addEventListener("click",function(e){t.isDisabled()||"hidden"!=t._searchInput.style.visibility&&t._searchInput.focus()});var e=this._containerElement.style;e.display="flex",e.alignItems="center",e.flexWrap="wrap"}},{key:"_configureSearchInput",value:function(){var e=this._searchInput;e.type="text",e.autocomplete="field-"+Date.now(),e.spellcheck=!1,attrs(e,{"aria-autocomplete":"list","aria-haspopup":"menu","aria-expanded":"false","aria-label":this._config.searchLabel,role:"combobox"}),e.style.cssText="background-color:transparent;color:currentColor;border:0;padding:0;outline:0;max-width:100%",this.resetSearchInput(!0),this._containerElement.appendChild(e),this._rtl="rtl"===window.getComputedStyle(e).direction}},{key:"onfocus",value:function(e){this._holderElement.classList.add(FOCUS_CLASS),this.showOrSearch(),this._config.onFocus(e,this)}},{key:"onblur",value:function(e){this._abortController&&this._abortController.abort();var t=!0;this._config.addOnBlur&&this._searchInput.value&&(t=this._enterValue()),this._holderElement.classList.remove(FOCUS_CLASS),this.hideSuggestions(t),this._fireEvents&&(t={selection:(t=this.getSelection())?t.dataset.value:null,input:this._searchInput.value},this._config.onBlur(e,this),this._selectElement.dispatchEvent(new CustomEvent("tags.blur",{bubbles:!0,detail:t})))}},{key:"oninput",value:function(e){var t=this,i=this._searchInput.value;if(i){i=i.slice(-1);if(this._config.separator.length&&this._config.separator.includes(i)){this._searchInput.value=this._searchInput.value.slice(0,-1);var n=this._searchInput.value,s=n,r={};if(this._config.allowNew)r.new=1;else{i=this.getSelection();if(!i)return;n=i.getAttribute(VALUE_ATTRIBUTE),s=i.dataset.label}return void this._config.confirmAdd(n,this).then(function(){t._add(s,n,r)}).catch(function(){})}}setTimeout(function(){t._adjustWidth()}),this.showOrSearch()}},{key:"onkeydown",value:function(e){var t=this,i=e.keyCode||e.key,n=e.target;switch(229==e.keyCode&&(i=n.value.charAt(n.selectionStart-1).charCodeAt(0)),i){case 13:case"Enter":e.preventDefault(),this._enterValue();break;case 38:case"ArrowUp":e.preventDefault(),this._keyboardNavigation=!0,this._moveSelection(PREV);break;case 40:case"ArrowDown":e.preventDefault(),this._keyboardNavigation=!0,this.isDropdownVisible()?this._moveSelection(NEXT):this.showOrSearch(!1);break;case 8:case"Backspace":var s=this.getLastItem();0==this._searchInput.value.length&&s&&this._config.confirmClear(s,this).then(function(){t.removeLastItem(),t._adjustWidth(),t.showOrSearch()}).catch(function(){});break;case 27:case"Escape":this._searchInput.focus(),this.hideSuggestions()}}},{key:"onmousemove",value:function(e){this._keyboardNavigation=!1}},{key:"onscroll",value:function(e){this._positionMenu()}},{key:"onresize",value:function(e){this._positionMenu()}},{key:"onclick",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&e.preventDefault(),!this.isSingle()&&this.isMaxReached()||this._searchInput.focus()}},{key:"onreset",value:function(e){this.reset()}},{key:"loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];0<Object.keys(this._config.items).length?this.setData(this._config.items,!0):this.resetSuggestions(!0),this._config.server&&(this._config.liveServer||this._loadFromServer(!e))}},{key:"_setSelectedAttributes",value:function(){for(var e=this._selectElement.selectedOptions||[],t=0;t<e.length;t++)e[t].value&&!e[t].hasAttribute("selected")&&e[t].setAttribute("selected","selected")}},{key:"resetState",value:function(){this.isDisabled()?(this._holderElement.setAttribute("readonly",""),this._searchInput.setAttribute("disabled",""),this._holderElement.classList.add(DISABLED_CLASS)):(rmAttr(this._holderElement,"readonly"),rmAttr(this._searchInput,"disabled"),this._holderElement.classList.remove(DISABLED_CLASS))}},{key:"resetSuggestions",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._setSelectedAttributes();function i(e){return{value:e.getAttribute("value"),label:e.textContent,disabled:e.disabled,selected:e.selected,data:Object.assign({disabled:e.disabled},e.dataset)}}var n=Array.from(this._selectElement.children).filter(function(e){return e.hasAttribute("label")||!e.disabled||t._config.showDisabled}).map(function(e){return e.hasAttribute("label")?{group:e.getAttribute("label"),items:Array.from(e.children).map(i)}:i(e)});this.setData(n,e)}},{key:"_enterValue",value:function(){var e=this,t=this.getSelection();if(t)return t.click(),!0;if(this._config.allowNew&&this._searchInput.value){var i=this._searchInput.value;return this._config.confirmAdd(i,this).then(function(){e._add(i,i,{new:1})}).catch(function(){}),!0}return!1}},{key:"_loadFromServer",value:function(){var t=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._abortController&&this._abortController.abort(),this._abortController=new AbortController;var e=this._selectElement.dataset.serverParams||{};"string"==typeof e&&(e=JSON.parse(e));e=Object.assign({},this._config.serverParams,e);e[this._config.queryParam]=this._searchInput.value,this._config.noCache&&(e.t=Date.now()),!e.related||(s=document.getElementById(e.related))&&(e.related=s.value,(n=s.getAttribute("name"))&&(e[n]=s.value));var n=new URLSearchParams(e),s=this._config.server,e=Object.assign(this._config.fetchOptions,{method:this._config.serverMethod||"GET",signal:this._abortController.signal});"POST"===e.method?e.body=n:s+="?"+n.toString(),this._holderElement.classList.add(LOADING_CLASS),fetch(s,e).then(function(e){return t._config.onServerResponse(e,t)}).then(function(e){e=e[t._config.serverDataKey]||e;t.setData(e,!i),t._abortController=null,i&&t._showSuggestions()}).catch(function(e){"AbortError"!==e.name&&console.error(e)}).finally(function(e){t._holderElement.classList.remove(LOADING_CLASS)})}},{key:"_add",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!this.canAdd(e,i))return null;i=this.addItem(e,t,i);return this._resetHtmlState(),this._config.keepOpen?this._showSuggestions():this.resetSearchInput(),i}},{key:"_isItemEnabled",value:function(e){if("none"===e.style.display)return!1;e=e.firstElementChild;return"A"===e.tagName&&!e.classList.contains("disabled")}},{key:"_moveSelection",value:function(){var e,t,i,n,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:NEXT,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,o=this.getSelection();if(o){for(var a,l=s===NEXT?"nextSibling":"previousSibling",r=o.parentNode;r=r[l],r&&!this._isItemEnabled(r););r?(a=o.classList).remove.apply(a,_toConsumableArray(this._activeClasses())):o&&(r=o.parentElement)}else{if(s===PREV)return r;if(!r)for(r=this._dropElement.firstChild;r&&!this._isItemEnabled(r);)r=r.nextSibling}return r?(e=r.offsetHeight,n=r.offsetTop,i=(t=r.parentNode).offsetHeight,a=t.scrollHeight,o=t.offsetTop,0===e&&setTimeout(function(){t.scrollTop=0}),s===PREV?(s=10<n-o?n-o:0,t.scrollTop=s):0<n+e-(i+t.scrollTop)&&0<e&&(t.scrollTop=n+e-i+1,t.scrollTop+i>=a-10&&(t.scrollTop=n-o)),(o=(n=r.querySelector("a")).classList).add.apply(o,_toConsumableArray(this._activeClasses())),this._searchInput.setAttribute("aria-activedescendant",n.id),this._config.updateOnSelect&&(this._searchInput.value=n.dataset.label,this._adjustWidth())):this._searchInput.setAttribute("aria-activedescendant",""),r}},{key:"_adjustWidth",value:function(){this._holderElement.classList.remove(PLACEHOLDER_CLASS),this._searchInput.value?this._searchInput.size=this._searchInput.value.length:this.getSelectedValues().length?(this._searchInput.placeholder="",this._searchInput.size=1):(this._searchInput.size=0<this._config.placeholder.length?this._config.placeholder.length:1,this._searchInput.placeholder=this._config.placeholder,this._holderElement.classList.add(PLACEHOLDER_CLASS));var e=calcTextWidth(this._searchInput.value||this._searchInput.placeholder,window.getComputedStyle(this._holderElement).fontSize)+16;this._searchInput.style.width=e+"px"}},{key:"_buildSuggestions",value:function(e){for(;this._dropElement.lastChild;)this._dropElement.removeChild(this._dropElement.lastChild);for(var t,i=0,n=1,s=0;s<e.length;s++){var r=e[s];if(r){if(r.group&&r.items){var o,a=ce("li");a.setAttribute("role","presentation"),a.dataset.id=""+n;var l=ce("span");if(a.append(l),(o=l.classList).add.apply(o,["dropdown-header","text-truncate"]),l.innerHTML=r.group,this._dropElement.appendChild(a),r.items)for(var c=0;c<r.items.length;c++)r.items[c].group_id=n,this._buildSuggestionsItem(r.items[c],i),i++;n++}this._buildSuggestionsItem(r,i),i++}}this._config.notFoundMessage&&((t=ce("li")).setAttribute("role","presentation"),t.classList.add(CLASS_PREFIX+"not-found"),t.innerHTML='<span class="dropdown-item"></span>',this._dropElement.appendChild(t))}},{key:"_buildSuggestionsItem",value:function(t,e){var i,n,s,r,o,a=this;t[this._config.valueField]&&(i=t[this._config.valueField],n=t[this._config.labelField],s=this._config.onRenderItem(t,n,this),(r=ce("li")).setAttribute("role","presentation"),t.group_id&&r.setAttribute("data-group-id",""+t.group_id),o=ce("a"),r.append(o),o.id=this._dropElement.id+"-"+e,(e=o.classList).add.apply(e,["dropdown-item","text-truncate"]),t.disabled&&(e=o.classList).add.apply(e,["disabled"]),o.setAttribute(VALUE_ATTRIBUTE,i),o.dataset.label=n,this._config.searchFields.forEach(function(e){r.dataset[e]=t[e]}),o.setAttribute("href","#"),o.innerHTML=s,this._dropElement.appendChild(r),o.addEventListener("mouseenter",function(e){var t;a._keyboardNavigation||(a.removeSelection(),(t=r.querySelector("a").classList).add.apply(t,_toConsumableArray(a._activeClasses())))}),o.addEventListener("mousedown",function(e){e.preventDefault()}),o.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),a._config.confirmAdd(i,a).then(function(){a._add(n,i,t.data),a._config.onSelectItem(t,a)}).catch(function(){})}))}},{key:"initialOptions",value:function(){return this._selectElement.querySelectorAll("option[data-init]")}},{key:"_removeSelectedAttrs",value:function(){this._selectElement.querySelectorAll("option").forEach(function(e){rmAttr(e,"selected")})}},{key:"reset",value:function(){this.removeAll(),this._fireEvents=!1;var e=this.initialOptions();this._removeSelectedAttrs();for(var t=0;t<e.length;t++){var i=e[t],n=Object.assign({},{disabled:i.hasAttribute("disabled")},i.dataset);this.addItem(i.textContent,i.value,n)}this._resetHtmlState(),this._fireEvents=!0}},{key:"resetSearchInput",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._searchInput.value="",this._adjustWidth(),e||(this._shouldShow()||this.hideSuggestions(),this._searchInput===document.activeElement&&this._searchInput.dispatchEvent(new Event("input"))),this.isMaxReached()?(this._holderElement.classList.add(MAX_REACHED_CLASS),this._searchInput.style.visibility="hidden"):"hidden"==this._searchInput.style.visibility&&(this._searchInput.style.visibility="visible"),this.isSingle()&&!e&&document.activeElement.blur()}},{key:"getSelectedValues",value:function(){var e=this._selectElement.querySelectorAll("option[selected]");return Array.from(e).map(function(e){return e.value})}},{key:"getAvailableValues",value:function(){var e=this._selectElement.querySelectorAll("option");return Array.from(e).map(function(e){return e.value})}},{key:"showOrSearch",value:function(){!(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])||this._shouldShow()?this._config.liveServer?this._searchFunc():this._showSuggestions():this.hideSuggestions(!1)}},{key:"hideSuggestions",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._dropElement.classList.remove(SHOW_CLASS),attrs(this._searchInput,{"aria-expanded":"false"}),this.removeSelection(),e&&this._holderElement.classList.remove(INVALID_CLASS)}},{key:"toggleSuggestions",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this._dropElement.classList.contains(SHOW_CLASS)?this.hideSuggestions(t):this.showOrSearch(e)}},{key:"_shouldShow",value:function(){return!this.isDisabled()&&!this.isMaxReached()&&this._searchInput.value.length>=this._config.suggestionsThreshold}},{key:"_showSuggestions",value:function(){var r=this;if(document.activeElement==this._searchInput&&"hidden"!=this._searchInput.style.visibility){for(var e,t,o=normalize(this._searchInput.value),a={},l=this._dropElement.querySelectorAll("li"),c=0,h=null,u=!1,d={},f=0;f<l.length;f++)(function(){var e=l[f],t=e.firstElementChild;if(t instanceof HTMLSpanElement)return e.dataset.id&&(d[e.dataset.id]=!1),hideItem(e);if((n=t.classList).remove.apply(n,_toConsumableArray(r._activeClasses())),!r._config.allowSame){var i=t.getAttribute(VALUE_ATTRIBUTE);if(a[i]=a[i]||0,r._findOption(t.getAttribute(VALUE_ATTRIBUTE),"[selected]",a[i]++))return hideItem(e)}var n=r._config.showAllSuggestions||0===o.length,s=0==o.length&&0===r._config.suggestionsThreshold;!n&&0<o.length&&r._config.searchFields.forEach(function(e){e=normalize(t.dataset[e]);(r._config.fuzzy?fuzzyMatch(e,o):(e=e.indexOf(o),r._config.startsWith?0===e:0<=e))&&(s=!0)});i=s||0===o.length;n||s?(c++,showItem(e),e.dataset.groupId&&(d[e.dataset.groupId]=!0),!h&&r._isItemEnabled(e)&&i&&(h=e),0<r._config.maximumItems&&c>r._config.maximumItems&&hideItem(e)):hideItem(e),r._config.highlightTyped&&(i=normalize(n=t.textContent).indexOf(o),n=n.substring(0,i)+'<mark class="'.concat(r._config.highlightClass,'">').concat(n.substring(i,i+o.length),"</mark>")+n.substring(i+o.length,n.length),t.innerHTML=n),r._isItemEnabled(e)&&(u=!0)})();this._config.allowNew||0===o.length&&!u||this._holderElement.classList.add(INVALID_CLASS),this._config.allowNew&&this._config.regex&&this.isInvalid()&&this._holderElement.classList.remove(INVALID_CLASS),Array.from(l).filter(function(e){return e.dataset.id}).forEach(function(e){!0===d[e.dataset.id]&&showItem(e)}),u&&(this._holderElement.classList.remove(INVALID_CLASS),h&&this._config.autoselectFirst&&(this.removeSelection(),this._moveSelection(NEXT,h))),0===c?this._config.notFoundMessage?((e=this._dropElement.querySelector("."+CLASS_PREFIX+"not-found")).style.display="block",t=this._config.notFoundMessage.replace("{{tag}}",this._searchInput.value),e.innerHTML='<span class="dropdown-item">'.concat(t,"</span>"),this._showDropdown()):this.hideSuggestions(!1):this._showDropdown()}}},{key:"_showDropdown",value:function(){var e=this._dropElement.classList.contains(SHOW_CLASS);e||(this._dropElement.classList.add(SHOW_CLASS),attrs(this._searchInput,{"aria-expanded":"true"})),this._positionMenu(e)}},{key:"_positionMenu",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this._rtl,i=this._config.fixed,n=this._config.fullWidth,s=this._searchInput.getBoundingClientRect(),r=this._holderElement.getBoundingClientRect(),o=0,a=0,a=i?n?(o=r.x,r.y+r.height+2):(o=s.x,s.y+s.height):n?(o=0,r.height+2):(o=this._searchInput.offsetLeft,this._searchInput.offsetHeight+this._searchInput.offsetTop);t&&!n&&(o-=this._dropElement.offsetWidth-s.width),n||(i=Math.min(window.innerWidth,document.body.offsetWidth),(i=t?s.x+s.width-this._dropElement.offsetWidth-1:i-1-(s.x+this._dropElement.offsetWidth))<0&&(o=t?o-i:o+i)),n&&(this._dropElement.style.width=this._holderElement.offsetWidth+"px"),e||(this._dropElement.style.transform="unset"),Object.assign(this._dropElement.style,{left:o+"px",top:a+"px"});o=this._dropElement.getBoundingClientRect(),a=window.innerHeight;(o.y+o.height>a||this._dropElement.style.transform.includes("translateY"))&&(s=n?r.height+4:s.height,this._dropElement.style.transform="translateY(calc(-100.1% - "+s+"px))")}},{key:"_getBootstrapVersion",value:function(){var e=5,t=window.jQuery;return t&&t.fn.tooltip&&t.fn.tooltip.Constructor&&(e=parseInt(t.fn.tooltip.Constructor.VERSION.charAt(0))),e}},{key:"_isSelected",value:function(t){return!!Array.from(this._selectElement.querySelectorAll("option")).find(function(e){return e.textContent==t&&e.getAttribute("selected")})}},{key:"_isSelectable",value:function(t){var e=Array.from(this._selectElement.querySelectorAll("option")).filter(function(e){return e.textContent==t});if(0<e.length&&!e.find(function(e){return!e.getAttribute("selected")}))return!1;return!0}},{key:"hasItem",value:function(e){var t=_createForOfIteratorHelper(this._config.items);try{for(t.s();!(n=t.n()).done;){var i,n=n.value,s=_createForOfIteratorHelper(n.items||[n]);try{for(s.s();!(i=s.n()).done;)if(i.value[this._config.labelField]==e)return!0}catch(e){s.e(e)}finally{s.f()}}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"_validateRegex",value:function(e){return new RegExp(this._config.regex.trim()).test(e)}},{key:"getSelection",value:function(){return this._dropElement.querySelector("a."+ACTIVE_CLASS)}},{key:"removeSelection",value:function(){var e=this.getSelection();e&&(e=e.classList).remove.apply(e,_toConsumableArray(this._activeClasses()))}},{key:"_activeClasses",value:function(){return[].concat(_toConsumableArray(this._config.activeClasses),[ACTIVE_CLASS])}},{key:"getActiveSelection",value:function(){return this.getSelection()}},{key:"removeActiveSelection",value:function(){return this.removeSelection()}},{key:"removeAll",value:function(){var t=this;this.getSelectedValues().forEach(function(e){t.removeItem(e,!0)}),this._adjustWidth()}},{key:"removeLastItem",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.getLastItem();t&&this.removeItem(t,e)}},{key:"getLastItem",value:function(){var e=this._containerElement.querySelectorAll("span."+CLASS_PREFIX+"badge");if(e.length)return e[e.length-1].getAttribute(VALUE_ATTRIBUTE)}},{key:"enable",value:function(){this._selectElement.setAttribute("disabled",""),this.resetState()}},{key:"disable",value:function(){rmAttr(this._selectElement,"disabled"),this.resetState()}},{key:"isDisabled",value:function(){return this._selectElement.hasAttribute("disabled")||this._selectElement.disabled||this._selectElement.hasAttribute("readonly")}},{key:"isDropdownVisible",value:function(){return this._dropElement.classList.contains(SHOW_CLASS)}},{key:"isInvalid",value:function(){return this._holderElement.classList.contains(INVALID_CLASS)}},{key:"isSingle",value:function(){return!this._selectElement.hasAttribute("multiple")}},{key:"isMaxReached",value:function(){return this._config.max&&this.getSelectedValues().length>=this._config.max}},{key:"canAdd",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;if(t.new&&!this._config.allowNew)return!1;if(!t.new&&!this.hasItem(e))return!1;if(this.isDisabled())return!1;if(!this.isSingle()&&!this._config.allowSame)if(t.new){if(this._isSelected(e))return!1}else if(!this._isSelectable(e))return!1;return!this.isMaxReached()&&((!this._config.regex||!t.new||this._validateRegex(e))&&(!this._config.onCanAdd||!1!==this._config.onCanAdd(e,t,this))||(this._holderElement.classList.add(INVALID_CLASS),!1))}},{key:"getData",value:function(){return this._config.items}},{key:"setData",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];Array.isArray(e)||(e=Object.entries(e).map(function(e){e=_slicedToArray(e,2);return{value:e[0],label:e[1]}})),this._config.items!=e&&(this._config.items=e),t&&(this._removeSelectedAttrs(),e.forEach(function(e){var t=e[n._config.valueField],i=e[n._config.labelField];t&&(!e.selected&&!n._config.selected.includes(t)||(e=n.addItem(i,t,e.data))&&e.setAttribute("data-init","true"))})),this._buildSuggestions(e),this._resetHtmlState()}},{key:"_findOption",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,t="option"+(null===e?"":'[value="'+CSS.escape(e)+'"]')+t;return this._selectElement.querySelectorAll(t)[i]||null}},{key:"addItem",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},t=t||e;this.isSingle()&&this.getSelectedValues().length&&this.removeLastItem(!0);var n=this._findOption(t,":not([selected])");if(!n){(n=ce("option")).value=t,n.textContent=e;for(var s=0,r=Object.entries(i);s<r.length;s++){var o=_slicedToArray(r[s],2),a=o[0],o=o[1];n.dataset[a]=o}this._selectElement.appendChild(n),this._config.onCreateItem(n,this)}return n&&(i=Object.assign({title:n.getAttribute("title")},i,n.dataset)),n.setAttribute("selected","selected"),n.selected=!0,this._createBadge(e,t,i),this._fireEvents&&this._selectElement.dispatchEvent(new Event("change",{bubbles:!0})),n}},{key:"_resetHtmlState",value:function(){var e=this._selectElement.innerHTML;this._selectElement.innerHTML="",this._selectElement.innerHTML=e,this._adjustWidth()}},{key:"_createBadge",value:function(e){var t=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=5===this._getBootstrapVersion(),r=n.disabled&&parseBool(n.disabled),o=this._config.allowClear&&!r,a=e,l=ce("span"),c=[CLASS_PREFIX+"badge"],h=this.isSingle()&&!this._config.singleBadge;h||(c.push("badge"),e=this._config.badgeStyle,n.badgeStyle&&(e=n.badgeStyle),n.badgeClass&&c.push.apply(c,_toConsumableArray(n.badgeClass.split(" "))),this._config.baseClass?c.push.apply(c,_toConsumableArray(this._config.baseClass.split(" "))):c=s?[].concat(_toConsumableArray(c),["bg-"+e],["text-truncate"]):[].concat(_toConsumableArray(c),["badge-"+e]),l.style.maxWidth="100%"),r&&c.push.apply(c,["disabled","opacity-50"]);var r=h?0:2;l.style.margin=r+"px 6px "+r+"px 0px",l.style.marginBlock=r+"px",l.style.marginInline="0px 6px",(r=l.classList).add.apply(r,_toConsumableArray(c)),l.setAttribute(VALUE_ATTRIBUTE,i),n.title&&l.setAttribute("title",n.title),o&&(r=c.includes("text-dark")||h?"btn-close":"btn-close btn-close-white",c="margin-inline: 0px 6px;",h="left",this._config.clearEnd&&(h="right"),"right"==h&&(c="margin-inline: 6px 0px;"),c=s?'<button type="button" style="font-size:0.65em;'+c+'" class="'+r+'" aria-label="'+this._config.clearLabel+'"></button>':'<button type="button" style="font-size:1em;'+c+'text-shadow:none;color:currentColor;transform:scale(1.2);float:none" class="close" aria-label="'+this._config.clearLabel+'"><span aria-hidden="true">&times;</span></button>',a="left"==h?c+a:a+c),l.innerHTML=a,this._containerElement.insertBefore(l,this._searchInput),n.title&&tooltip&&s&&tooltip.getOrCreateInstance(l),o&&l.querySelector("button").addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.isDisabled()||t._config.confirmClear(i,t).then(function(){t.removeItem(i),document.activeElement.blur(),t._adjustWidth()}).catch(function(){})})}},{key:"removeItem",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=CSS.escape(e),n=this._containerElement.querySelectorAll("span["+VALUE_ATTRIBUTE+'="'+i+'"]');n.length&&((n=n[i=n.length-1])&&(n.dataset.bsOriginalTitle&&tooltip.getOrCreateInstance(n).dispose(),n.remove()),(i=this._findOption(e,"[selected]",i))&&(rmAttr(i,"selected"),i.selected=!1,this._fireEvents&&!t&&this._selectElement.dispatchEvent(new Event("change",{bubbles:!0}))),"hidden"!=this._searchInput.style.visibility||this.isMaxReached()||(this._searchInput.style.visibility="visible",this._holderElement.classList.remove(MAX_REACHED_CLASS)),t||this._config.onClearItem(e,this))}}],[{key:"init",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"select[multiple]",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=document.querySelectorAll(e),n=0;n<i.length;n++)s.getInstance(i[n])||new s(i[n],t)}},{key:"getInstance",value:function(e){if(INSTANCE_MAP.has(e))return INSTANCE_MAP.get(e)}}]),s}();
